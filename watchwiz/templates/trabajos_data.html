<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<div class="container mt-4">
    <div class="row">
        {% for trabajo in trabajos %}
            <div class="col-md-4">
                <div class="card mb-3" onclick="showDetails('{{ trabajo.id }}')">
                    <img src="{{ trabajo.photo }}" class="card-img-top" alt="Imagen del Trabajo">
                    <div class="card-body">
                        <h5 class="card-title">{{ trabajo.client_name }}</h5>
                        <p class="card-text">{{ trabajo.description }}</p>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
</div>

<!-- Modal para mostrar detalles del trabajo -->
<div class="modal fade" id="trabajoModal" tabindex="-1" aria-labelledby="trabajoModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="trabajoModalLabel">Detalles del Trabajo</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
            </div>
            <div class="modal-body" id="trabajo-details">
                <!-- Los detalles se cargarán dinámicamente aquí -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

<script>
    // Función para mostrar el modal con los detalles del trabajo
    function showDetails(trabajoId) {
        const trabajos = {{ trabajos|safe }}; // Renderizar los datos como JSON
        const trabajo = trabajos.find(t => t.id === trabajoId);

        if (trabajo) {
            // Generar el contenido del modal
            const detallesHtml = `
                <p><strong>Nombre del Cliente:</strong> ${trabajo.client_name}</p>
                <p><strong>Teléfono:</strong> ${trabajo.phone_number}</p>
                <p><strong>Descripción:</strong> ${trabajo.description}</p>
                <p><strong>Costo del Servicio:</strong> ${trabajo.service_cost}</p>
                <p><strong>Anticipo:</strong> ${trabajo.advance}</p>
                <p><strong>Faltante:</strong> ${trabajo.remaining}</p>
                <p><strong>Fecha de Recepción:</strong> ${trabajo.received_date}</p>
                <p><strong>Fecha de Revisión:</strong> ${trabajo.review_date}</p>
                <img src="${trabajo.photo}" alt="Imagen del Trabajo" class="img-fluid">
            `;
            document.getElementById('trabajo-details').innerHTML = detallesHtml;

            // Mostrar el modal
            const modal = new bootstrap.Modal(document.getElementById('trabajoModal'));
            modal.show();
        }
    }
</script>
